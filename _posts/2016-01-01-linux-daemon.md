---
layout: default
---

-----
##linux守护进程的学习笔记
在linux系统中，守护进程也称为精灵进程，是一种生存期较长的一种进程，没有控制终端，常常在系统自动自举时启动，在系统关闭的时候终止。以下记录编写守护进程的一些规则。
##编写守护进程的规则
下面是编写守护进程的一些规则。
* 调用umask将文件模式创建屏蔽字设置为0，这样做是由于继承得来的文件模式创建屏蔽字可能会拒绝设置某些权限，例如，若守护进程要创建一个组可读，可写的文件，而继承文件模式创建屏蔽字可能屏蔽了这两种权限。
* 调用fork,然后使父进程退出.这样做实现了以下几点：1、如果该守护进程是作为一条简单的shell命令启动，那么父进程终止使得shell认为这条命令已经执行完毕；2、子进程继承了父进程的进程组ID，但具有一个新的进程ID，这就保证了子进程不是一个进程组的组长进程。这个是进行setsid调用的必要条件。
* 调用setsid以建立一个新的会话。这个调用，使得进程：1、成为新会话的首进程 2、成为一个新进程组的组长进程 3、没有控制终端
* 将当前工作目录更改为根目录
* 关闭不需要的文件描述符
* 某些守护进程打开/dev/null使其具有文件描述符0,1,2
